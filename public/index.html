<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Wrestling Graph</title>
  <!-- Graphology + Sigma UMD builds -->
  <script src="https://unpkg.com/graphology@0.25.4/dist/graphology.umd.min.js"></script>
  <script src="https://unpkg.com/sigma@3.0.0/dist/sigma.min.js"></script>
  <script src="https://unpkg.com/sigma@3.0.0/dist/sigma.min.js"></script>
  <script src="https://unpkg.com/graphology-layout-force@0.2.4/index.js" type="module"></script>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      height: 100%;
      overflow: hidden;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
    }
    #container {
      width: 100vw;
      height: 100vh;
    }
    .sigma-tooltip {
      position: absolute;
      background: rgba(0, 0, 0, 0.8);
      color: #fff;
      padding: 4px 8px;
      border-radius: 4px;
      font-size: 12px;
      pointer-events: none;
      z-index: 10;
    }
  </style>
</head>
<body>
  <div id="container"></div>

  <script>
    const container = document.getElementById("container");

    // simple tooltip div
    const tooltip = document.createElement("div");
    tooltip.className = "sigma-tooltip";
    tooltip.style.display = "none";
    document.body.appendChild(tooltip);

    // Load graph JSON generated by Python
    fetch("graph.json")
      .then(r => r.json())
      .then(data => {
        const Graph = window.graphology;
        const graph = new Graph();

        graph.import({
          nodes: data.nodes.map(n => ({
            key: n.id,
            attributes: {
              ...n.attributes,
              x: n.attributes.x * 10,
              y: n.attributes.y * 10,
              size: n.attributes.size / 4,
            },
          })),
          edges: data.edges.map(e => ({
            ...e,
            attributes: {
              ...e.attributes,
              size: 0.1,
            }
          })),
        });

        // Initialize Sigma
        const renderer = new Sigma.Sigma(graph, container, {
          renderEdgeLabels: false,
          allowInvalidContainer: false,
        });

        // Node hover tooltip
        renderer.on("enterNode", ({ node }) => {
          const attrs = graph.getNodeAttributes(node);
          tooltip.innerText = attrs.label || node;
          tooltip.style.display = "block";
        });

        renderer.on("leaveNode", () => {
          tooltip.style.display = "none";
        });

        renderer.getMouseCaptor().on("mousemove", (e) => {
          if (tooltip.style.display !== "none") {
            tooltip.style.left = e.clientX + 10 + "px";
            tooltip.style.top = e.clientY + 10 + "px";
          }
        });

        // Optional: focus on a node when clicked
        renderer.on("clickNode", ({ node }) => {
          const cam = renderer.getCamera();
          const pos = renderer.getNodeDisplayData(node);
          cam.animate(
            {
              x: pos.x,
              y: pos.y,
              ratio: 0.2,
            },
            { duration: 500 }
          );
        });
      });
  </script>
</body>
</html>
